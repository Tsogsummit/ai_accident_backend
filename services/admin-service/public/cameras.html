<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞–º–µ—Ä—É—É–¥ - Admin Panel</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/dashboard.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .camera-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1.5rem; }
    .camera-card { background: var(--white); border-radius: 12px; overflow: hidden; box-shadow: var(--shadow); transition: transform 0.2s; }
    .camera-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
    .camera-preview { position: relative; height: 200px; background: #000; display: flex; align-items: center; justify-content: center; }
    .camera-preview img { width: 100%; height: 100%; object-fit: cover; }
    .camera-placeholder { color: var(--secondary); font-size: 3rem; }
    .camera-status-badge { position: absolute; top: 0.75rem; right: 0.75rem; padding: 0.375rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
    .camera-status-badge.online { background: rgba(16, 185, 129, 0.9); color: white; }
    .camera-status-badge.offline { background: rgba(100, 116, 139, 0.9); color: white; }
    .camera-info { padding: 1rem; }
    .camera-name { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.25rem; }
    .camera-location { font-size: 0.875rem; color: var(--secondary); margin-bottom: 0.75rem; }
    .camera-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-bottom: 1rem; }
    .stat-item { text-align: center; padding: 0.5rem; background: var(--light); border-radius: 6px; }
    .stat-value { font-size: 1.25rem; font-weight: 700; color: var(--dark); }
    .stat-label { font-size: 0.75rem; color: var(--secondary); text-transform: uppercase; }
    .camera-actions { display: flex; gap: 0.5rem; padding-top: 1rem; border-top: 1px solid var(--border); }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center; }
    .modal.active { display: flex; }
    .modal-content { background: var(--white); border-radius: 12px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; }
    .modal-header { padding: 1.5rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .modal-body { padding: 1.5rem; }
    .form-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
  </style>
</head>
<body>
  <div class="admin-container">
    <aside class="sidebar">
      <div class="sidebar-header"><h2><i class="fas fa-car-crash"></i> Admin Panel</h2><p>AI Accident Detection</p></div>
      <nav class="sidebar-nav">
        <div class="nav-item"><a href="/dashboard.html" class="nav-link"><i class="fas fa-th-large"></i><span>–î–∞—à–±–æ–∞—Ä–¥</span></a></div>
        <div class="nav-item"><a href="/accidents.html" class="nav-link"><i class="fas fa-exclamation-triangle"></i><span>–û—Å–ª—É—É–¥</span></a></div>
        <div class="nav-item"><a href="/users.html" class="nav-link"><i class="fas fa-users"></i><span>–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥</span></a></div>
        <div class="nav-item"><a href="/cameras.html" class="nav-link active"><i class="fas fa-video"></i><span>–ö–∞–º–µ—Ä—É—É–¥</span></a></div>
        <div class="nav-item"><a href="/reports.html" class="nav-link"><i class="fas fa-chart-bar"></i><span>–¢–∞–π–ª–∞–Ω–≥—É—É–¥</span></a></div>
        <div class="nav-item"><a href="/services.html" class="nav-link"><i class="fas fa-server"></i><span>–°–µ—Ä–≤–∏—Å“Ø“Ø–¥</span></a></div>
      </nav>
    </aside>
    <div class="main-content">
      <div class="topbar">
        <div class="topbar-left"><h1>üìπ –ö–∞–º–µ—Ä—ã–Ω –£–¥–∏—Ä–¥–ª–∞–≥–∞</h1></div>
        <div class="topbar-right">
          <div class="user-info"><div class="user-avatar">A</div><div class="user-details"><div class="user-name">Admin</div><div class="user-role">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div></div></div>
          <button class="btn btn-sm btn-danger" id="logout-btn"><i class="fas fa-sign-out-alt"></i> –ì–∞—Ä–∞—Ö</button>
        </div>
      </div>
      <div class="content">
        <div class="stats-grid">
          <div class="stat-card"><div class="stat-info"><div class="stat-label">–ù–∏–π—Ç –ö–∞–º–µ—Ä</div><div class="stat-value" id="totalCameras">0</div></div><div class="stat-icon primary"><i class="fas fa-video"></i></div></div>
          <div class="stat-card"><div class="stat-info"><div class="stat-label">–ò–¥—ç–≤—Ö—Ç—ç–π</div><div class="stat-value" id="activeCameras">0</div></div><div class="stat-icon success"><i class="fas fa-check-circle"></i></div></div>
          <div class="stat-card"><div class="stat-info"><div class="stat-label">–ë–∏—á–ª—ç–≥ —Ö–∏–π–∂ –±–∞–π–≥–∞–∞</div><div class="stat-value" id="recordingCameras">0</div></div><div class="stat-icon danger"><i class="fas fa-record-vinyl"></i></div></div>
          <div class="stat-card"><div class="stat-info"><div class="stat-label">–ò–ª—ç—Ä—Å—ç–Ω (24—Ü)</div><div class="stat-value" id="hourlyDetections">0</div></div><div class="stat-icon warning"><i class="fas fa-eye"></i></div></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">–ö–∞–º–µ—Ä—É—É–¥</h3>
            <div style="display: flex; gap: 0.5rem;">
              <button class="btn btn-secondary btn-sm" onclick="refreshCameras()"><i class="fas fa-sync"></i> –®–∏–Ω—ç—á–ª—ç—Ö</button>
              <button class="btn btn-primary btn-sm" onclick="openAddModal()"><i class="fas fa-plus"></i> –ö–∞–º–µ—Ä –Ω—ç–º—ç—Ö</button>
            </div>
          </div>
          <div class="card-body">
            <div id="camerasContainer" class="camera-grid"><div class="loading"><div class="spinner"></div><p>–ê—á–∞–∞–ª–ª–∞–∂ –±–∞–π–Ω–∞...</p></div></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="cameraModal" class="modal">
    <div class="modal-content">
      <div class="modal-header"><h2 id="modalTitle">–ö–∞–º–µ—Ä –Ω—ç–º—ç—Ö</h2><button onclick="closeModal()" style="border: none; background: none; font-size: 1.5rem; cursor: pointer;">&times;</button></div>
      <div class="modal-body">
        <form id="cameraForm" onsubmit="handleSubmit(event)">
          <div class="form-group"><label class="form-label">–ù—ç—Ä *</label><input type="text" name="name" id="camera-name" class="form-control" required></div>
          <div class="form-group"><label class="form-label">–ë–∞–π—Ä—à–∏–ª *</label><input type="text" name="location" id="camera-location" class="form-control" required></div>
          <div class="form-row">
            <div class="form-group"><label class="form-label">”®—Ä–≥”©—Ä”©–≥ *</label><input type="number" name="latitude" id="camera-latitude" class="form-control" step="0.000001" required></div>
            <div class="form-group"><label class="form-label">–£—Ä—Ç—Ä–∞–≥ *</label><input type="number" name="longitude" id="camera-longitude" class="form-control" step="0.000001" required></div>
          </div>
          <div class="form-group"><label class="form-label">Stream URL *</label><input type="url" name="stream_url" id="camera-stream" class="form-control" placeholder="https://stream.ubtraffic.mn/live/32770.stream_480p/playlist.m3u8" required><small style="color: var(--secondary);">HLS (.m3u8) —ç—Å–≤—ç–ª RTSP (rtsp://) URL</small></div>
          <div class="form-row">
            <div class="form-group"><label class="form-label">Resolution</label><select name="resolution" id="camera-resolution" class="form-control form-select"><option value="480p">480p</option><option value="720p" selected>720p</option><option value="1080p">1080p</option></select></div>
            <div class="form-group"><label class="form-label">FPS</label><input type="number" name="fps" id="camera-fps" class="form-control" value="25" min="1" max="60"></div>
          </div>
          <div class="form-group"><label class="form-label">IP Address</label><input type="text" name="ip_address" id="camera-ip" class="form-control" placeholder="192.168.1.100"></div>
          <div class="form-group"><label class="form-label">–¢”©–ª”©–≤</label><select name="status" id="camera-status" class="form-control form-select"><option value="active">–ò–¥—ç–≤—Ö—Ç—ç–π</option><option value="inactive">–ò–¥—ç–≤—Ö–≥“Ø–π</option><option value="maintenance">–ó–∞—Å–≤–∞—Ä</option></select></div>
          <div class="form-group"><label class="form-label">–¢–∞–π–ª–±–∞—Ä</label><textarea name="description" id="camera-description" class="form-control" rows="3"></textarea></div>
          <div style="display: flex; gap: 0.5rem; justify-content: flex-end; margin-top: 1.5rem;">
            <button type="button" class="btn btn-secondary" onclick="closeModal()">–ë–æ–ª–∏—Ö</button>
            <button type="submit" class="btn btn-primary" id="save-btn">–•–∞–¥–≥–∞–ª–∞—Ö</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script src="/js/api.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/cameras.js"></script>
</body>
</html>